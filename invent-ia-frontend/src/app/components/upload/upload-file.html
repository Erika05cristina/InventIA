<div class="upload-container">
  <!-- üìÅ Subida de archivo CSV -->
  <label class="upload-label">
    <span class="upload-button">
      <span class="material-symbols-rounded icon">folder_open</span>
      Selecciona un archivo CSV
    </span>
    <input type="file" accept=".csv" (change)="onFileSelected($event)" />
  </label>

  <!-- üü° Loader de carga CSV -->
  @if (isUploading()) {
    <div class="loader-box loader-upload">
      <span class="spinner"></span>
      <p>Cargando archivo CSV...</p>
    </div>
  }

  <!-- ‚úÖ Vista previa -->
  @if (!isUploading() && previewData().length > 0) {
    <div class="preview">
      <h3>Vista previa:</h3>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              @for (header of previewData()[0]; track $index) {
                <th>{{ header }}</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (row of previewData().slice(1); track $index) {
              <tr>
                @for (cell of row; track $index) {
                  <td>{{ cell }}</td>
                }
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  }

  <!-- üü¢ Entrenamiento en progreso -->
  @if (isTraining()) {
    <div class="loader-box loader-training">
      <span class="spinner"></span>
      <p>Entrenando modelo en segundo plano...</p>
    </div>
  }

  <!-- ‚úÖ Mensaje de entrenamiento completado -->
  @if (trainingCompleted()) {
    <div class="loader-box loader-success">
      <span class="material-symbols-rounded">check_circle</span>
      <p>Modelo entrenado exitosamente</p>
    </div>
  }

  <!-- üìù Inputs individuales -->
  <div class="manual-input">
    <label>
      ID del producto:
      <input type="number" [(ngModel)]="manualProductIdValue" />
    </label>

    <label>
      Fecha:
      <input type="date" [(ngModel)]="manualFechaValue" />
    </label>

    <button (click)="getPrediction()">Predecir individual</button>
  </div>

  <!-- ‚úÖ Resultado de predicci√≥n individual -->
  @if (predictionResult()) {
    <div class="prediction-box">
      <h3>Resultado de predicci√≥n:</h3>
      <ul>
        @for (r of predictionResult(); track r.productId) {
          <li>
            Producto #{{ r.productId }} que se necesita para la fecha {{ r.date }}:
            <strong>{{ r.prediction }}</strong>
          </li>
        }
      </ul>
    </div>
  }

  <!-- üìù Inputs de predicci√≥n por grupo -->
  <div class="manual-input">
    <label>
      Fecha:
      <input type="date" [(ngModel)]="fecha" />
    </label>

    <button (click)="getGroupPrediction()">Predecir todos los productos</button>
  </div>

  <!-- üü¢ Mensaje de descarga grupo -->
  @if (wasGroupPredictionDownloaded()) {
    <div class="loader-box loader-predict">
      <span class="material-symbols-rounded">download_done</span>
      <p>Predicci√≥n para todos los productos descargada correctamente</p>
    </div>
  }

  <!-- üîµ Loader de predicci√≥n -->
  @if (isPredicting()) {
    <div class="loader-box loader-predict">
      <span class="spinner"></span>
      <p>Procesando predicci√≥n...</p>
    </div>
  }

</div>